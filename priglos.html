<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–æ–∑—ã–≥—Ä—ã—à –ø—Ä–∏–∑–æ–≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary: #6a11cb;
            --secondary: #2575fc;
            --accent: #ff4081;
            --light: rgba(255, 255, 255, 0.9);
            --dark: #333;
            --success: #4CAF50;
            --warning: #FFC107;
            --danger: #F44336;
            --info: #2196F3;
        }
        
        body {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 30px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            flex: 1;
            min-width: 300px;
        }
        
        .card h2 {
            margin-bottom: 20px;
            font-size: 1.8rem;
            border-bottom: 2px solid rgba(255, 255, 255, 0.3);
            padding-bottom: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: none;
            border-radius: 8px;
            background: var(--light);
            font-size: 1rem;
        }
        
        button {
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 64, 129, 0.4);
        }
        
        button:hover {
            background: #f50057;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 64, 129, 0.6);
        }
        
        .participants-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .participant-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .winner-display {
            text-align: center;
            padding: 30px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            margin-top: 20px;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .winner-name {
            font-size: 2.5rem;
            margin: 20px 0;
            color: #ffeb3b;
            text-shadow: 0 0 10px rgba(255, 235, 59, 0.5);
        }
        
        .prize-name {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .history-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .history-date {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-bottom: 5px;
        }
        
        .delete-btn {
            background: rgba(255, 0, 0, 0.7);
            padding: 5px 10px;
            font-size: 0.8rem;
        }
        
        .delete-btn:hover {
            background: rgba(255, 0, 0, 0.9);
        }
        
        .admin-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--warning);
            color: var(--dark);
        }
        
        .admin-btn:hover {
            background: #ffb300;
        }
        
        .admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }
        
        .admin-content {
            background: white;
            color: var(--dark);
            max-width: 1000px;
            margin: 40px auto;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }
        
        .admin-section {
            margin-bottom: 30px;
        }
        
        .admin-section h3 {
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .participants-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .participants-table th, .participants-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .participants-table th {
            background: var(--primary);
            color: white;
        }
        
        .participants-table tr:hover {
            background: #f5f5f5;
        }
        
        .close-admin {
            background: var(--danger);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .tab-buttons {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .tab-button {
            padding: 10px 20px;
            background: none;
            border: none;
            cursor: pointer;
            color: var(--dark);
            font-weight: 500;
            border-bottom: 3px solid transparent;
        }
        
        .tab-button.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #ffeb3b;
            animation: spin 1s ease-in-out infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .hidden {
            display: none;
        }
        
        .message {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .success {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid var(--success);
            color: var(--success);
        }
        
        .error {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
        }
        
        .giveaway-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .giveaway-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .giveaway-card.active {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid var(--accent);
        }
        
        .giveaway-card.completed {
            background: rgba(76, 175, 80, 0.2);
            border: 2px solid var(--success);
        }
        
        .winners-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .winner-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .winner-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .winner-card.selected {
            background: rgba(255, 235, 59, 0.2);
            border: 2px solid #ffeb3b;
        }
        
        .winner-card.confirmed {
            background: rgba(76, 175, 80, 0.2);
            border: 2px solid var(--success);
        }
        
        .profile-link {
            color: #ffeb3b;
            text-decoration: none;
            margin: 0 5px;
            transition: all 0.3s ease;
        }
        
        .profile-link:hover {
            text-decoration: underline;
            color: #fff;
        }
        
        .random-btn {
            background: var(--primary);
        }
        
        .redraw-btn {
            background: var(--warning);
            color: var(--dark);
        }
        
        .confirm-btn {
            background: var(--success);
        }
        
        .complete-btn {
            background: var(--info);
        }
        
        .winner-history {
            margin-top: 10px;
            font-size: 0.9rem;
        }
        
        .first-time-winner {
            color: var(--success);
        }
        
        .repeat-winner {
            color: var(--warning);
        }
        
        .last-win-date {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .win-history-list {
            margin-top: 10px;
            font-size: 0.8rem;
            text-align: left;
            max-height: 100px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.2);
            padding: 8px;
            border-radius: 5px;
        }
        
        .win-history-item {
            padding: 3px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .win-history-item:last-child {
            border-bottom: none;
        }
        
        .selected-winner-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            text-align: center;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .status-active {
            background: var(--success);
            color: white;
        }
        
        .status-completed {
            background: var(--info);
            color: white;
        }
        
        .all-giveaways-list {
            margin-top: 20px;
        }
        
        .giveaway-history-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .giveaway-history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .giveaway-history-title {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .giveaway-history-date {
            font-size: 0.9rem;
            opacity: 0.7;
        }
        
        .giveaway-history-prize {
            margin-bottom: 10px;
            font-style: italic;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .admin-content {
                margin: 20px auto;
                padding: 20px;
            }
            
            .winners-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .giveaway-history-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>–†–æ–∑—ã–≥—Ä—ã—à –ø—Ä–∏–∑–æ–≤</h1>
            <p class="subtitle">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –¥–ª—è —É—á–∞—Å—Ç–∏—è –≤ —Ä–æ–∑—ã–≥—Ä—ã—à–µ!</p>
        </header>
        
        <div class="main-content">
            <div class="card">
                <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —Ä–æ–∑—ã–≥—Ä—ã—à</h2>
                <div id="registration-message"></div>
                
                <div class="form-group">
                    <label for="current-giveaway-select">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–∑—ã–≥—Ä—ã—à</label>
                    <select id="current-giveaway-select">
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–∑—ã–≥—Ä—ã—à --</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="participant-twitch">–ù–∏–∫ –Ω–∞ Twitch</label>
                    <input type="text" id="participant-twitch" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫ –Ω–∞ Twitch">
                </div>
                <div class="form-group">
                    <label for="participant-telegram">–ù–∏–∫ –≤ Telegram</label>
                    <input type="text" id="participant-telegram" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫ –≤ Telegram">
                </div>
                <div class="form-group">
                    <label for="participant-code">–ö–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ</label>
                    <input type="text" id="participant-code" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ">
                </div>
                
                <button id="register-participant">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                
                <h2 style="margin-top: 30px;">–¢–µ–∫—É—â–∏–π —Ä–æ–∑—ã–≥—Ä—ã—à</h2>
                <div id="current-giveaway-info">
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–∑—ã–≥—Ä—ã—à –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</p>
                </div>
            </div>
            
            <div class="card">
                <h2>–ê–∫—Ç–∏–≤–Ω—ã–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∏</h2>
                <div id="active-giveaways-main">
                    <!-- –ê–∫—Ç–∏–≤–Ω—ã–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
                
                <h2 style="margin-top: 30px;">–ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π</h2>
                <div id="all-giveaways-list">
                    <!-- –í—Å–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
        
        <button class="admin-btn" id="admin-btn">–ê–¥–º–∏–Ω–∫–∞</button>
        
        <div class="admin-panel" id="admin-panel">
            <div class="admin-content">
                <div class="admin-header">
                    <h2>–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
                    <button class="close-admin" id="close-admin">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
                
                <div class="tab-buttons">
                    <button class="tab-button active" data-tab="login">–í—Ö–æ–¥</button>
                    <button class="tab-button" data-tab="giveaways">–†–æ–∑—ã–≥—Ä—ã—à–∏</button>
                    <button class="tab-button" data-tab="participants">–£—á–∞—Å—Ç–Ω–∏–∫–∏</button>
                    <button class="tab-button" data-tab="winners">–ü–æ–±–µ–¥–∏—Ç–µ–ª–∏</button>
                </div>
                
                <div id="login-tab" class="tab-content active">
                    <div class="form-group">
                        <label for="admin-login">–õ–æ–≥–∏–Ω</label>
                        <input type="text" id="admin-login" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω">
                    </div>
                    <div class="form-group">
                        <label for="admin-password">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="admin-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                    </div>
                    <button id="admin-login-btn">–í–æ–π—Ç–∏</button>
                    <div id="admin-login-message"></div>
                </div>
                
                <div id="giveaways-tab" class="tab-content">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∞–º–∏</h3>
                    
                    <div class="form-group">
                        <label for="giveaway-title">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∞</label>
                        <input type="text" id="giveaway-title" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∞">
                    </div>
                    <div class="form-group">
                        <label for="giveaway-prize">–ü—Ä–∏–∑</label>
                        <input type="text" id="giveaway-prize" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–∑–∞">
                    </div>
                    <div class="form-group">
                        <label for="giveaway-code-word">–ö–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ</label>
                        <input type="text" id="giveaway-code-word" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ">
                    </div>
                    <div class="form-group">
                        <label for="winners-count">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π</label>
                        <input type="number" id="winners-count" value="1" min="1">
                    </div>
                    <button id="create-giveaway">–°–æ–∑–¥–∞—Ç—å —Ä–æ–∑—ã–≥—Ä—ã—à</button>
                    <button id="update-giveaway" style="margin-left: 10px;">–û–±–Ω–æ–≤–∏—Ç—å —Ä–æ–∑—ã–≥—Ä—ã—à</button>
                    <div id="giveaway-message"></div>
                    
                    <h3 style="margin-top: 30px;">–ê–∫—Ç–∏–≤–Ω—ã–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∏</h3>
                    <div id="active-giveaways-list">
                        <!-- –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π -->
                    </div>
                </div>
                
                <div id="participants-tab" class="tab-content">
                    <h3>–£—á–∞—Å—Ç–Ω–∏–∫–∏ —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π</h3>
                    
                    <div class="form-group">
                        <label for="giveaway-filter">–§–∏–ª—å—Ç—Ä –ø–æ —Ä–æ–∑—ã–≥—Ä—ã—à—É</label>
                        <select id="giveaway-filter">
                            <option value="all">–í—Å–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∏</option>
                        </select>
                    </div>
                    
                    <table class="participants-table">
                        <thead>
                            <tr>
                                <th>Twitch</th>
                                <th>Telegram</th>
                                <th>–†–æ–∑—ã–≥—Ä—ã—à</th>
                                <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="participants-table-body">
                            <!-- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                        </tbody>
                    </table>
                </div>
                
                <div id="winners-tab" class="tab-content">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è–º–∏</h3>
                    
                    <div class="form-group">
                        <label for="giveaway-for-winner">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–∑—ã–≥—Ä—ã—à</label>
                        <select id="giveaway-for-winner">
                            <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–∑—ã–≥—Ä—ã—à --</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <button id="draw-random" class="random-btn">–í—ã–±—Ä–∞—Ç—å —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è</button>
                        <button id="draw-all-winners" style="margin-left: 10px;">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ—Ö –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π</button>
                    </div>
                    
                    <div id="winner-message"></div>
                    
                    <h3 style="margin-top: 30px;">–ü–æ–±–µ–¥–∏—Ç–µ–ª–∏</h3>
                    <div id="selected-winner-info" class="selected-winner-info" style="display: none;">
                        <p>–í—ã–±—Ä–∞–Ω –ø–æ–±–µ–¥–∏—Ç–µ–ª—å: <strong id="selected-winner-name"></strong></p>
                        <div class="action-buttons">
                            <button id="confirm-winner" class="confirm-btn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–æ–∑—ã–≥—Ä—ã—à</button>
                            <button id="confirm-redraw" class="redraw-btn">–ü–µ—Ä–µ–∏–∑–±—Ä–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è</button>
                        </div>
                    </div>
                    
                    <div id="winners-management-list">
                        <!-- –ü–æ–±–µ–¥–∏—Ç–µ–ª–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let giveaways = JSON.parse(localStorage.getItem('giveaways')) || [];
        let participants = JSON.parse(localStorage.getItem('participants')) || [];
        let winners = JSON.parse(localStorage.getItem('winners')) || [];
        let isAdminLoggedIn = false;
        let currentGiveawayId = null;
        let selectedWinnerId = null;
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const currentGiveawaySelect = document.getElementById('current-giveaway-select');
        const participantTwitchInput = document.getElementById('participant-twitch');
        const participantTelegramInput = document.getElementById('participant-telegram');
        const participantCodeInput = document.getElementById('participant-code');
        const registerParticipantBtn = document.getElementById('register-participant');
        const registrationMessage = document.getElementById('registration-message');
        const currentGiveawayInfo = document.getElementById('current-giveaway-info');
        const activeGiveawaysMain = document.getElementById('active-giveaways-main');
        const allGiveawaysList = document.getElementById('all-giveaways-list');
        
        const adminBtn = document.getElementById('admin-btn');
        const adminPanel = document.getElementById('admin-panel');
        const closeAdminBtn = document.getElementById('close-admin');
        
        const adminLoginInput = document.getElementById('admin-login');
        const adminPasswordInput = document.getElementById('admin-password');
        const adminLoginBtn = document.getElementById('admin-login-btn');
        const adminLoginMessage = document.getElementById('admin-login-message');
        
        const giveawayTitleInput = document.getElementById('giveaway-title');
        const giveawayPrizeInput = document.getElementById('giveaway-prize');
        const giveawayCodeWordInput = document.getElementById('giveaway-code-word');
        const winnersCountInput = document.getElementById('winners-count');
        const createGiveawayBtn = document.getElementById('create-giveaway');
        const updateGiveawayBtn = document.getElementById('update-giveaway');
        const giveawayMessage = document.getElementById('giveaway-message');
        const activeGiveawaysList = document.getElementById('active-giveaways-list');
        
        const giveawayFilter = document.getElementById('giveaway-filter');
        const participantsTableBody = document.getElementById('participants-table-body');
        
        const giveawayForWinner = document.getElementById('giveaway-for-winner');
        const drawRandomBtn = document.getElementById('draw-random');
        const drawAllWinnersBtn = document.getElementById('draw-all-winners');
        const winnerMessage = document.getElementById('winner-message');
        const winnersManagementList = document.getElementById('winners-management-list');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è–º–∏
        const selectedWinnerInfo = document.getElementById('selected-winner-info');
        const selectedWinnerName = document.getElementById('selected-winner-name');
        const confirmWinnerBtn = document.getElementById('confirm-winner');
        const confirmRedrawBtn = document.getElementById('confirm-redraw');
        
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // –§—É–Ω–∫—Ü–∏–∏
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }
        
        function updateGiveawaySelectors() {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (—Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∏)
            currentGiveawaySelect.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–∑—ã–≥—Ä—ã—à --</option>';
            giveawayFilter.innerHTML = '<option value="all">–í—Å–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∏</option>';
            giveawayForWinner.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–∑—ã–≥—Ä—ã—à --</option>';
            
            giveaways.forEach(giveaway => {
                // –î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∏
                if (giveaway.isActive && !giveaway.isCompleted) {
                    currentGiveawaySelect.innerHTML += `<option value="${giveaway.id}">${giveaway.title}</option>`;
                }
                
                giveawayFilter.innerHTML += `<option value="${giveaway.id}">${giveaway.title}</option>`;
                giveawayForWinner.innerHTML += `<option value="${giveaway.id}">${giveaway.title}</option>`;
            });
        }
        
        function updateCurrentGiveawayInfo() {
            if (!currentGiveawayId) {
                currentGiveawayInfo.innerHTML = '<p>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–∑—ã–≥—Ä—ã—à –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</p>';
                return;
            }
            
            const giveaway = giveaways.find(g => g.id === currentGiveawayId);
            if (!giveaway) {
                currentGiveawayInfo.innerHTML = '<p>–†–æ–∑—ã–≥—Ä—ã—à –Ω–µ –Ω–∞–π–¥–µ–Ω</p>';
                return;
            }
            
            const statusBadge = giveaway.isCompleted ? 
                '<span class="status-badge status-completed">–ó–∞–≤–µ—Ä—à–µ–Ω</span>' : 
                '<span class="status-badge status-active">–ê–∫—Ç–∏–≤–µ–Ω</span>';
            
            currentGiveawayInfo.innerHTML = `
                <p><strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong> ${giveaway.title} ${statusBadge}</p>
                <p><strong>–ü—Ä–∏–∑:</strong> ${giveaway.prize}</p>
                <p><strong>–ö–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ:</strong> ${giveaway.codeWord}</p>
                <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π:</strong> ${giveaway.winnersCount}</p>
                <p><strong>–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤:</strong> ${participants.filter(p => p.giveawayId === currentGiveawayId).length}</p>
                <p><strong>–í—ã–±—Ä–∞–Ω–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π:</strong> ${winners.filter(w => w.giveawayId === currentGiveawayId).length}</p>
            `;
        }
        
        function renderActiveGiveawaysMain() {
            activeGiveawaysMain.innerHTML = '';
            
            const activeGiveaways = giveaways.filter(g => g.isActive && !g.isCompleted);
            
            if (activeGiveaways.length === 0) {
                activeGiveawaysMain.innerHTML = '<p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç</p>';
                return;
            }
            
            activeGiveaways.forEach(giveaway => {
                const giveawayElement = document.createElement('div');
                giveawayElement.className = 'giveaway-card active';
                
                const winnerCount = winners.filter(w => w.giveawayId === giveaway.id).length;
                const participantCount = participants.filter(p => p.giveawayId === giveaway.id).length;
                
                giveawayElement.innerHTML = `
                    <h3>${giveaway.title}</h3>
                    <p><strong>–ü—Ä–∏–∑:</strong> ${giveaway.prize}</p>
                    <p><strong>–ö–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ:</strong> ${giveaway.codeWord}</p>
                    <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π:</strong> ${giveaway.winnersCount}</p>
                    <p><strong>–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤:</strong> ${participantCount}</p>
                    <p><strong>–í—ã–±—Ä–∞–Ω–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π:</strong> ${winnerCount}</p>
                    <p><strong>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong> ${new Date(giveaway.createdDate).toLocaleDateString('ru-RU')}</p>
                `;
                activeGiveawaysMain.appendChild(giveawayElement);
            });
        }
        
        function renderAllGiveawaysList() {
            allGiveawaysList.innerHTML = '';
            
            if (giveaways.length === 0) {
                allGiveawaysList.innerHTML = '<p>–†–æ–∑—ã–≥—Ä—ã—à–µ–π –µ—â–µ –Ω–µ –±—ã–ª–æ</p>';
                return;
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–æ–∑—ã–≥—Ä—ã—à–∏ –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è (–æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º)
            const sortedGiveaways = [...giveaways].sort((a, b) => new Date(b.createdDate) - new Date(a.createdDate));
            
            sortedGiveaways.forEach(giveaway => {
                const giveawayElement = document.createElement('div');
                giveawayElement.className = 'giveaway-history-item';
                
                const giveawayWinners = winners.filter(w => w.giveawayId === giveaway.id);
                const participantCount = participants.filter(p => p.giveawayId === giveaway.id).length;
                
                let winnersHTML = '';
                if (giveawayWinners.length > 0) {
                    winnersHTML = `
                        <div class="winners-grid">
                            ${giveawayWinners.map(winner => `
                                <div class="winner-card ${winner.confirmed ? 'confirmed' : ''}">
                                    <div class="winner-name">
                                        <a href="https://twitch.tv/${winner.twitch}" target="_blank" class="profile-link">${winner.twitch}</a>
                                        ${winner.confirmed ? '‚úÖ' : ''}
                                    </div>
                                    <div class="history-date">${new Date(winner.date).toLocaleString()}</div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else {
                    winnersHTML = '<p>–ü–æ–±–µ–¥–∏—Ç–µ–ª–∏ –µ—â–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã</p>';
                }
                
                const statusText = giveaway.isCompleted ? '–ó–∞–≤–µ—Ä—à–µ–Ω' : '–ê–∫—Ç–∏–≤–µ–Ω';
                const statusClass = giveaway.isCompleted ? 'status-completed' : 'status-active';
                
                giveawayElement.innerHTML = `
                    <div class="giveaway-history-header">
                        <div class="giveaway-history-title">
                            ${giveaway.title} 
                            <span class="status-badge ${statusClass}">${statusText}</span>
                        </div>
                        <div class="giveaway-history-date">
                            ${new Date(giveaway.createdDate).toLocaleDateString('ru-RU')}
                        </div>
                    </div>
                    <div class="giveaway-history-prize">
                        <strong>–ü—Ä–∏–∑:</strong> ${giveaway.prize}
                    </div>
                    <p><strong>–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤:</strong> ${participantCount}</p>
                    <p><strong>–ü–æ–±–µ–¥–∏—Ç–µ–ª–∏:</strong></p>
                    ${winnersHTML}
                `;
                allGiveawaysList.appendChild(giveawayElement);
            });
        }
        
        function renderActiveGiveaways() {
            activeGiveawaysList.innerHTML = '';
            
            const activeGiveaways = giveaways.filter(g => g.isActive);
            
            if (activeGiveaways.length === 0) {
                activeGiveawaysList.innerHTML = '<p>–ê–∫—Ç–∏–≤–Ω—ã—Ö —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π –Ω–µ—Ç</p>';
                return;
            }
            
            activeGiveaways.forEach(giveaway => {
                const giveawayElement = document.createElement('div');
                giveawayElement.className = `giveaway-card ${giveaway.isCompleted ? 'completed' : 'active'}`;
                
                const winnerCount = winners.filter(w => w.giveawayId === giveaway.id).length;
                const participantCount = participants.filter(p => p.giveawayId === giveaway.id).length;
                
                giveawayElement.innerHTML = `
                    <h4>${giveaway.title} ${giveaway.isCompleted ? '<span class="status-badge status-completed">–ó–∞–≤–µ—Ä—à–µ–Ω</span>' : '<span class="status-badge status-active">–ê–∫—Ç–∏–≤–µ–Ω</span>'}</h4>
                    <p><strong>–ü—Ä–∏–∑:</strong> ${giveaway.prize}</p>
                    <p><strong>–ö–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ:</strong> ${giveaway.codeWord}</p>
                    <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π:</strong> ${giveaway.winnersCount}</p>
                    <p><strong>–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤:</strong> ${participantCount}</p>
                    <p><strong>–í—ã–±—Ä–∞–Ω–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π:</strong> ${winnerCount}</p>
                    <div class="action-buttons">
                        <button class="edit-giveaway" data-id="${giveaway.id}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="complete-giveaway" data-id="${giveaway.id}" ${giveaway.isCompleted ? 'disabled' : ''}>–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–æ–∑—ã–≥—Ä—ã—à</button>
                        <button class="delete-giveaway" data-id="${giveaway.id}" style="margin-left: 10px;">–£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                `;
                activeGiveawaysList.appendChild(giveawayElement);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è
            document.querySelectorAll('.edit-giveaway').forEach(button => {
                button.addEventListener('click', function() {
                    const giveawayId = this.getAttribute('data-id');
                    const giveaway = giveaways.find(g => g.id === giveawayId);
                    
                    if (giveaway) {
                        giveawayTitleInput.value = giveaway.title;
                        giveawayPrizeInput.value = giveaway.prize;
                        giveawayCodeWordInput.value = giveaway.codeWord;
                        winnersCountInput.value = giveaway.winnersCount;
                        
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                        giveawayTitleInput.setAttribute('data-edit-id', giveawayId);
                    }
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞
            document.querySelectorAll('.complete-giveaway').forEach(button => {
                button.addEventListener('click', function() {
                    const giveawayId = this.getAttribute('data-id');
                    completeGiveaway(giveawayId);
                });
            });
            
            document.querySelectorAll('.delete-giveaway').forEach(button => {
                button.addEventListener('click', function() {
                    const giveawayId = this.getAttribute('data-id');
                    
                    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ä–æ–∑—ã–≥—Ä—ã—à?')) {
                        giveaways = giveaways.filter(g => g.id !== giveawayId);
                        // –¢–∞–∫–∂–µ —É–¥–∞–ª—è–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π —ç—Ç–æ–≥–æ —Ä–æ–∑—ã–≥—Ä—ã—à–∞
                        participants = participants.filter(p => p.giveawayId !== giveawayId);
                        winners = winners.filter(w => w.giveawayId !== giveawayId);
                        saveData();
                        renderActiveGiveaways();
                        updateGiveawaySelectors();
                        renderParticipantsTable();
                        renderWinnersManagement();
                        renderActiveGiveawaysMain();
                        renderAllGiveawaysList();
                    }
                });
            });
        }
        
        function renderParticipantsTable() {
            participantsTableBody.innerHTML = '';
            
            const filterValue = giveawayFilter.value;
            let filteredParticipants = participants;
            
            if (filterValue !== 'all') {
                filteredParticipants = participants.filter(p => p.giveawayId === filterValue);
            }
            
            if (filteredParticipants.length === 0) {
                participantsTableBody.innerHTML = '<tr><td colspan="5" style="text-align: center;">–£—á–∞—Å—Ç–Ω–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td></tr>';
                return;
            }
            
            filteredParticipants.forEach(participant => {
                const giveaway = giveaways.find(g => g.id === participant.giveawayId);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><a href="https://twitch.tv/${participant.twitch}" target="_blank" class="profile-link">${participant.twitch}</a></td>
                    <td><a href="https://t.me/${participant.telegram}" target="_blank" class="profile-link">@${participant.telegram}</a></td>
                    <td>${giveaway ? giveaway.title : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</td>
                    <td>${new Date(participant.registrationDate).toLocaleString()}</td>
                    <td>
                        <button class="delete-participant" data-id="${participant.id}">–£–¥–∞–ª–∏—Ç—å</button>
                    </td>
                `;
                participantsTableBody.appendChild(row);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
            document.querySelectorAll('.delete-participant').forEach(button => {
                button.addEventListener('click', function() {
                    const participantId = this.getAttribute('data-id');
                    deleteParticipant(participantId);
                });
            });
        }
        
        function renderWinnersManagement() {
            winnersManagementList.innerHTML = '';
            
            if (winners.length === 0) {
                winnersManagementList.innerHTML = '<p>–ü–æ–±–µ–¥–∏—Ç–µ–ª–∏ –µ—â–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã</p>';
                return;
            }
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –ø–æ —Ä–æ–∑—ã–≥—Ä—ã—à–∞–º
            const winnersByGiveaway = {};
            winners.forEach(winner => {
                if (!winnersByGiveaway[winner.giveawayId]) {
                    winnersByGiveaway[winner.giveawayId] = [];
                }
                winnersByGiveaway[winner.giveawayId].push(winner);
            });
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –ø–æ —Ä–æ–∑—ã–≥—Ä—ã—à–∞–º
            for (const giveawayId in winnersByGiveaway) {
                const giveaway = giveaways.find(g => g.id === giveawayId);
                if (!giveaway) continue;
                
                const giveawayWinners = winnersByGiveaway[giveawayId];
                
                const giveawayElement = document.createElement('div');
                giveawayElement.className = 'giveaway-card';
                giveawayElement.innerHTML = `
                    <h4>${giveaway.title}</h4>
                    <div class="winners-grid">
                        ${giveawayWinners.map(winner => `
                            <div class="winner-card ${winner.confirmed ? 'confirmed' : ''}" data-id="${winner.id}">
                                <div class="winner-name">
                                    <a href="https://twitch.tv/${winner.twitch}" target="_blank" class="profile-link">${winner.twitch}</a>
                                    ${winner.confirmed ? '‚úÖ' : ''}
                                </div>
                                <div>
                                    <a href="https://t.me/${winner.telegram}" target="_blank" class="profile-link">@${winner.telegram}</a>
                                </div>
                                <div class="history-date">${new Date(winner.date).toLocaleString()}</div>
                                <div class="action-buttons">
                                    <button class="delete-winner" data-id="${winner.id}">–£–¥–∞–ª–∏—Ç—å</button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                winnersManagementList.appendChild(giveawayElement);
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
            document.querySelectorAll('.winner-card').forEach(card => {
                card.addEventListener('click', function() {
                    // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —É –≤—Å–µ—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
                    document.querySelectorAll('.winner-card').forEach(c => {
                        c.classList.remove('selected');
                    });
                    
                    // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É
                    this.classList.add('selected');
                    selectedWinnerId = this.getAttribute('data-id');
                    const winnerName = this.querySelector('.winner-name').textContent.trim();
                    selectedWinnerName.textContent = winnerName;
                    selectedWinnerInfo.style.display = 'block';
                });
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π
            document.querySelectorAll('.delete-winner').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.stopPropagation(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤—Å–ø–ª—ã—Ç–∏–µ —Å–æ–±—ã—Ç–∏—è
                    const winnerId = this.getAttribute('data-id');
                    
                    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è?')) {
                        winners = winners.filter(w => w.id !== winnerId);
                        saveData();
                        renderWinnersManagement();
                        renderAllGiveawaysList();
                    }
                });
            });
        }
        
        function drawRandomWinner() {
            const giveawayId = giveawayForWinner.value;
            if (!giveawayId) {
                showMessage(winnerMessage, '–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–∑—ã–≥—Ä—ã—à', 'error');
                return;
            }
            
            const giveaway = giveaways.find(g => g.id === giveawayId);
            if (!giveaway) {
                showMessage(winnerMessage, '–†–æ–∑—ã–≥—Ä—ã—à –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            const giveawayParticipants = participants.filter(p => p.giveawayId === giveawayId);
            if (giveawayParticipants.length === 0) {
                showMessage(winnerMessage, '–ù–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–∫–æ–ª—å–∫–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π —É–∂–µ –≤—ã–±—Ä–∞–Ω–æ
            const existingWinners = winners.filter(w => w.giveawayId === giveawayId);
            if (existingWinners.length >= giveaway.winnersCount) {
                showMessage(winnerMessage, '–í—Å–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª–∏ —É–∂–µ –≤—ã–±—Ä–∞–Ω—ã –¥–ª—è —ç—Ç–æ–≥–æ —Ä–æ–∑—ã–≥—Ä—ã—à–∞', 'error');
                return;
            }
            
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –µ—â–µ –Ω–µ –≤—ã–∏–≥—Ä–∞–ª
            const availableParticipants = giveawayParticipants.filter(p => 
                !existingWinners.some(w => w.twitch === p.twitch)
            );
            
            if (availableParticipants.length === 0) {
                showMessage(winnerMessage, '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è', 'error');
                return;
            }
            
            const randomIndex = Math.floor(Math.random() * availableParticipants.length);
            const winner = availableParticipants[randomIndex];
            
            addWinner(winner, giveawayId);
        }
        
        function addWinner(winner, giveawayId) {
            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –ø–æ–±–µ–¥—ã —É—á–∞—Å—Ç–Ω–∏–∫–∞ (–≤–∫–ª—é—á–∞—è —Ç–µ–∫—É—â—É—é)
            const allWins = winners.filter(w => w.twitch === winner.twitch);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å—Ç–æ—Ä–∏—é –ø–æ–±–µ–¥ —É—á–∞—Å—Ç–Ω–∏–∫–∞ (–±–µ–∑ —Ç–µ–∫—É—â–µ–π –ø–æ–±–µ–¥—ã)
            const previousWins = allWins.filter(w => w.giveawayId !== giveawayId);
            const isFirstWin = previousWins.length === 0;
            
            // –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é –ø–æ–±–µ–¥ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const userWinHistory = winners
                .filter(w => w.twitch === winner.twitch)
                .sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ
            const winnerRecord = {
                id: generateId(),
                giveawayId,
                twitch: winner.twitch,
                telegram: winner.telegram,
                date: new Date().toISOString(),
                confirmed: false
            };
            
            winners.push(winnerRecord);
            saveData();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–æ–±–µ–¥–∞—Ö
            let winMessage = `–ü–æ–±–µ–¥–∏—Ç–µ–ª—å: <a href="https://twitch.tv/${winner.twitch}" target="_blank" class="profile-link">${winner.twitch}</a> (Telegram: <a href="https://t.me/${winner.telegram}" target="_blank" class="profile-link">@${winner.telegram}</a>)`;
            
            if (isFirstWin) {
                winMessage += `<div class="winner-history first-time-winner">üéâ –ü–µ—Ä–≤–∞—è –ø–æ–±–µ–¥–∞!</div>`;
            } else {
                winMessage += `<div class="winner-history repeat-winner">üèÜ –£–∂–µ –ø–æ–±–µ–∂–¥–∞–ª ${previousWins.length} —Ä–∞–∑(–∞) —Ä–∞–Ω–µ–µ</div>`;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –ø–æ–±–µ–¥
                if (userWinHistory.length > 0) {
                    winMessage += `<div class="win-history-list">`;
                    userWinHistory.forEach(win => {
                        const giveawayTitle = giveaways.find(g => g.id === win.giveawayId)?.title || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ä–æ–∑—ã–≥—Ä—ã—à';
                        winMessage += `<div class="win-history-item">${new Date(win.date).toLocaleString('ru-RU')} - ${giveawayTitle}</div>`;
                    });
                    winMessage += `</div>`;
                }
            }
            
            winMessage += `<div>üé≤ –í—ã–±—Ä–∞–Ω —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º</div>`;
            winMessage += `<div><strong>–ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–æ–∑—ã–≥—Ä—ã—à!</strong></div>`;
            
            showMessage(winnerMessage, winMessage, 'success');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            renderWinnersManagement();
            renderAllGiveawaysList();
        }
        
        function confirmWinner() {
            if (!selectedWinnerId) {
                showMessage(winnerMessage, '–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è', 'error');
                return;
            }
            
            const winnerIndex = winners.findIndex(w => w.id === selectedWinnerId);
            if (winnerIndex === -1) {
                showMessage(winnerMessage, '–ü–æ–±–µ–¥–∏—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            const winner = winners[winnerIndex];
            const giveawayId = winner.giveawayId;
            const giveawayIndex = giveaways.findIndex(g => g.id === giveawayId);
            
            if (giveawayIndex === -1) {
                showMessage(winnerMessage, '–†–æ–∑—ã–≥—Ä—ã—à –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
            winners[winnerIndex].confirmed = true;
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∞–µ–º —Ä–æ–∑—ã–≥—Ä—ã—à
            giveaways[giveawayIndex].isCompleted = true;
            giveaways[giveawayIndex].completedDate = new Date().toISOString();
            
            saveData();
            
            showMessage(winnerMessage, `–ü–æ–±–µ–¥–∏—Ç–µ–ª—å <strong>${winner.twitch}</strong> –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω –∏ —Ä–æ–∑—ã–≥—Ä—ã—à –∑–∞–≤–µ—Ä—à–µ–Ω! ‚úÖ`, 'success');
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
            selectedWinnerId = null;
            selectedWinnerInfo.style.display = 'none';
            document.querySelectorAll('.winner-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            updateGiveawaySelectors();
            renderActiveGiveaways();
            renderActiveGiveawaysMain();
            renderAllGiveawaysList();
            renderWinnersManagement();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä —Ä–æ–∑—ã–≥—Ä—ã—à–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            currentGiveawayId = null;
            currentGiveawaySelect.value = '';
            updateCurrentGiveawayInfo();
        }
        
        function redrawWinner() {
            if (!selectedWinnerId) {
                showMessage(winnerMessage, '–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –¥–ª—è –ø–µ—Ä–µ–∏–∑–±—Ä–∞–Ω–∏—è', 'error');
                return;
            }
            
            const winnerIndex = winners.findIndex(w => w.id === selectedWinnerId);
            if (winnerIndex === -1) {
                showMessage(winnerMessage, '–ü–æ–±–µ–¥–∏—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            const winner = winners[winnerIndex];
            const giveawayId = winner.giveawayId;
            const giveaway = giveaways.find(g => g.id === giveawayId);
            
            if (!giveaway) {
                showMessage(winnerMessage, '–†–æ–∑—ã–≥—Ä—ã—à –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            const giveawayParticipants = participants.filter(p => p.giveawayId === giveawayId);
            if (giveawayParticipants.length === 0) {
                showMessage(winnerMessage, '–ù–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞', 'error');
                return;
            }
            
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –µ—â–µ –Ω–µ –≤—ã–∏–≥—Ä–∞–ª (–∏—Å–∫–ª—é—á–∞—è —Ç–µ–∫—É—â–µ–≥–æ)
            const availableParticipants = giveawayParticipants.filter(p => 
                !winners.some(w => w.twitch === p.twitch && w.giveawayId === giveawayId)
            );
            
            if (availableParticipants.length === 0) {
                showMessage(winnerMessage, '–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è –ø–µ—Ä–µ–∏–∑–±—Ä–∞–Ω–∏—è', 'error');
                return;
            }
            
            const randomIndex = Math.floor(Math.random() * availableParticipants.length);
            const newWinner = availableParticipants[randomIndex];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
            winners[winnerIndex] = {
                ...winners[winnerIndex],
                twitch: newWinner.twitch,
                telegram: newWinner.telegram,
                date: new Date().toISOString(),
                confirmed: false
            };
            
            saveData();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–µ—Ä–µ–∏–∑–±—Ä–∞–Ω–∏–∏
            showMessage(winnerMessage, `–ü–æ–±–µ–¥–∏—Ç–µ–ª—å –ø–µ—Ä–µ–∏–∑–±—Ä–∞–Ω! –ù–æ–≤—ã–π –ø–æ–±–µ–¥–∏—Ç–µ–ª—å: <a href="https://twitch.tv/${newWinner.twitch}" target="_blank" class="profile-link">${newWinner.twitch}</a>`, 'success');
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
            selectedWinnerId = null;
            selectedWinnerInfo.style.display = 'none';
            document.querySelectorAll('.winner-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            renderWinnersManagement();
            renderAllGiveawaysList();
        }
        
        function drawAllWinners() {
            if (!isAdminLoggedIn) {
                showMessage(winnerMessage, '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å', 'error');
                return;
            }
            
            const giveawayId = giveawayForWinner.value;
            if (!giveawayId) {
                showMessage(winnerMessage, '–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–∑—ã–≥—Ä—ã—à', 'error');
                return;
            }
            
            const giveaway = giveaways.find(g => g.id === giveawayId);
            if (!giveaway) {
                showMessage(winnerMessage, '–†–æ–∑—ã–≥—Ä—ã—à –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            const giveawayParticipants = participants.filter(p => p.giveawayId === giveawayId);
            if (giveawayParticipants.length === 0) {
                showMessage(winnerMessage, '–ù–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–∫–æ–ª—å–∫–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π —É–∂–µ –≤—ã–±—Ä–∞–Ω–æ
            const existingWinners = winners.filter(w => w.giveawayId === giveawayId);
            const winnersNeeded = giveaway.winnersCount - existingWinners.length;
            
            if (winnersNeeded <= 0) {
                showMessage(winnerMessage, '–í—Å–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª–∏ —É–∂–µ –≤—ã–±—Ä–∞–Ω—ã –¥–ª—è —ç—Ç–æ–≥–æ —Ä–æ–∑—ã–≥—Ä—ã—à–∞', 'error');
                return;
            }
            
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –µ—â–µ –Ω–µ –≤—ã–∏–≥—Ä–∞–ª
            const availableParticipants = giveawayParticipants.filter(p => 
                !existingWinners.some(w => w.twitch === p.twitch)
            );
            
            if (availableParticipants.length < winnersNeeded) {
                showMessage(winnerMessage, `–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ ${winnersNeeded} –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π`, 'error');
                return;
            }
            
            // –í—ã–±–∏—Ä–∞–µ–º –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π
            const selectedWinners = [];
            const shuffled = [...availableParticipants].sort(() => 0.5 - Math.random());
            
            for (let i = 0; i < winnersNeeded; i++) {
                const winner = shuffled[i];
                
                const winnerRecord = {
                    id: generateId(),
                    giveawayId,
                    twitch: winner.twitch,
                    telegram: winner.telegram,
                    date: new Date().toISOString(),
                    confirmed: false
                };
                
                winners.push(winnerRecord);
                selectedWinners.push(winner);
            }
            
            saveData();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è—Ö
            const winnersText = selectedWinners.map(w => {
                const previousWins = winners.filter(win => win.twitch === w.twitch).length - 1;
                let winInfo = `<a href="https://twitch.tv/${w.twitch}" target="_blank" class="profile-link">${w.twitch}</a>`;
                
                if (previousWins > 0) {
                    // –ü–æ–ª—É—á–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –ø–æ–±–µ–¥
                    const userWinHistory = winners
                        .filter(win => win.twitch === w.twitch && win.giveawayId !== giveawayId)
                        .sort((a, b) => new Date(b.date) - new Date(a.date))
                        .slice(0, 3); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –ø–æ–±–µ–¥—ã
                    
                    const lastWinDate = userWinHistory.length > 0 ? 
                        new Date(userWinHistory[0].date).toLocaleDateString('ru-RU') : '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                    
                    winInfo += ` [${previousWins} –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–æ–±–µ–¥, –ø–æ—Å–ª–µ–¥–Ω—è—è: ${lastWinDate}]`;
                } else {
                    winInfo += ` [–ø–µ—Ä–≤–∞—è –ø–æ–±–µ–¥–∞]`;
                }
                
                return winInfo;
            }).join(', ');
            
            showMessage(winnerMessage, `–ü–æ–±–µ–¥–∏—Ç–µ–ª–∏: ${winnersText}`, 'success');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π
            renderWinnersManagement();
            renderAllGiveawaysList();
        }
        
        function deleteParticipant(participantId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞?')) {
                participants = participants.filter(p => p.id !== participantId);
                saveData();
                renderParticipantsTable();
                showMessage(winnerMessage, '–£—á–∞—Å—Ç–Ω–∏–∫ —É–¥–∞–ª–µ–Ω', 'success');
            }
        }
        
        function completeGiveaway(giveawayId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–≤–µ—Ä—à–∏—Ç—å —ç—Ç–æ—Ç —Ä–æ–∑—ã–≥—Ä—ã—à? –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞.')) {
                const giveawayIndex = giveaways.findIndex(g => g.id === giveawayId);
                if (giveawayIndex !== -1) {
                    giveaways[giveawayIndex].isCompleted = true;
                    giveaways[giveawayIndex].completedDate = new Date().toISOString();
                    saveData();
                    renderActiveGiveaways();
                    updateGiveawaySelectors();
                    renderActiveGiveawaysMain();
                    renderAllGiveawaysList();
                    showMessage(winnerMessage, '–†–æ–∑—ã–≥—Ä—ã—à –∑–∞–≤–µ—Ä—à–µ–Ω', 'success');
                }
            }
        }
        
        function saveData() {
            localStorage.setItem('giveaways', JSON.stringify(giveaways));
            localStorage.setItem('participants', JSON.stringify(participants));
            localStorage.setItem('winners', JSON.stringify(winners));
        }
        
        function registerParticipant() {
            const giveawayId = currentGiveawaySelect.value;
            if (!giveawayId) {
                showMessage(registrationMessage, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–∑—ã–≥—Ä—ã—à', 'error');
                return;
            }
            
            const giveaway = giveaways.find(g => g.id === giveawayId);
            if (!giveaway) {
                showMessage(registrationMessage, '–†–æ–∑—ã–≥—Ä—ã—à –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–µ–Ω –ª–∏ —Ä–æ–∑—ã–≥—Ä—ã—à
            if (giveaway.isCompleted) {
                showMessage(registrationMessage, '–≠—Ç–æ—Ç —Ä–æ–∑—ã–≥—Ä—ã—à —É–∂–µ –∑–∞–≤–µ—Ä—à–µ–Ω, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞', 'error');
                return;
            }
            
            const twitch = participantTwitchInput.value.trim();
            const telegram = participantTelegramInput.value.trim();
            const code = participantCodeInput.value.trim();
            
            if (!twitch || !telegram || !code) {
                showMessage(registrationMessage, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            if (code !== giveaway.codeWord) {
                showMessage(registrationMessage, '–ù–µ–≤–µ—Ä–Ω–æ–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞ —Å —Ç–∞–∫–∏–º twitch –∏–ª–∏ telegram –≤ —ç—Ç–æ–º —Ä–æ–∑—ã–≥—Ä—ã—à–µ
            if (participants.some(p => p.giveawayId === giveawayId && (p.twitch === twitch || p.telegram === telegram))) {
                showMessage(registrationMessage, '–£—á–∞—Å—Ç–Ω–∏–∫ —Å —Ç–∞–∫–∏–º Twitch –∏–ª–∏ Telegram —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ —ç—Ç–æ–º —Ä–æ–∑—ã–≥—Ä—ã—à–µ', 'error');
                return;
            }
            
            const participant = {
                id: generateId(),
                giveawayId,
                twitch,
                telegram,
                registrationDate: new Date().toISOString()
            };
            
            participants.push(participant);
            saveData();
            
            showMessage(registrationMessage, '–í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Ä–æ–∑—ã–≥—Ä—ã—à!', 'success');
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞
            participantTwitchInput.value = '';
            participantTelegramInput.value = '';
            participantCodeInput.value = '';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º —Ä–æ–∑—ã–≥—Ä—ã—à–µ
            updateCurrentGiveawayInfo();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ
            if (isAdminLoggedIn) {
                renderParticipantsTable();
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–∫–∏ —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π
            renderActiveGiveawaysMain();
            renderAllGiveawaysList();
        }
        
        function showMessage(element, text, type) {
            element.innerHTML = `<div class="message ${type}">${text}</div>`;
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                element.innerHTML = '';
            }, 5000);
        }
        
        function adminLogin() {
            const login = adminLoginInput.value.trim();
            const password = adminPasswordInput.value.trim();
            
            // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–Ω–∞ –∏ –ø–∞—Ä–æ–ª—è
            if (login === 'admin' && password === 'admin123') {
                isAdminLoggedIn = true;
                showMessage(adminLoginMessage, '–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å', 'success');
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞–º–∏
                switchTab('giveaways');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                renderActiveGiveaways();
                renderParticipantsTable();
                renderWinnersManagement();
            } else {
                showMessage(adminLoginMessage, '–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å', 'error');
            }
        }
        
        function createGiveaway() {
            if (!isAdminLoggedIn) {
                showMessage(giveawayMessage, '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å', 'error');
                return;
            }
            
            const title = giveawayTitleInput.value.trim();
            const prize = giveawayPrizeInput.value.trim();
            const codeWord = giveawayCodeWordInput.value.trim();
            const winnersCount = parseInt(winnersCountInput.value) || 1;
            
            if (!title || !prize || !codeWord) {
                showMessage(giveawayMessage, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            const giveaway = {
                id: generateId(),
                title,
                prize,
                codeWord,
                winnersCount,
                isActive: true,
                isCompleted: false,
                createdDate: new Date().toISOString()
            };
            
            giveaways.push(giveaway);
            saveData();
            
            showMessage(giveawayMessage, '–†–æ–∑—ã–≥—Ä—ã—à —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω', 'success');
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞
            giveawayTitleInput.value = '';
            giveawayPrizeInput.value = '';
            giveawayCodeWordInput.value = '';
            winnersCountInput.value = '1';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏ —Å–ø–∏—Å–∫–∏
            updateGiveawaySelectors();
            renderActiveGiveaways();
            renderActiveGiveawaysMain();
            renderAllGiveawaysList();
        }
        
        function updateGiveaway() {
            if (!isAdminLoggedIn) {
                showMessage(giveawayMessage, '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å', 'error');
                return;
            }
            
            const giveawayId = giveawayTitleInput.getAttribute('data-edit-id');
            if (!giveawayId) {
                showMessage(giveawayMessage, '–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–∑—ã–≥—Ä—ã—à –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
                return;
            }
            
            const title = giveawayTitleInput.value.trim();
            const prize = giveawayPrizeInput.value.trim();
            const codeWord = giveawayCodeWordInput.value.trim();
            const winnersCount = parseInt(winnersCountInput.value) || 1;
            
            if (!title || !prize || !codeWord) {
                showMessage(giveawayMessage, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            const giveawayIndex = giveaways.findIndex(g => g.id === giveawayId);
            if (giveawayIndex === -1) {
                showMessage(giveawayMessage, '–†–æ–∑—ã–≥—Ä—ã—à –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            giveaways[giveawayIndex] = {
                ...giveaways[giveawayIndex],
                title,
                prize,
                codeWord,
                winnersCount
            };
            
            saveData();
            
            showMessage(giveawayMessage, '–†–æ–∑—ã–≥—Ä—ã—à —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞
            giveawayTitleInput.value = '';
            giveawayPrizeInput.value = '';
            giveawayCodeWordInput.value = '';
            winnersCountInput.value = '1';
            giveawayTitleInput.removeAttribute('data-edit-id');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –∏ —Å–ø–∏—Å–∫–∏
            updateGiveawaySelectors();
            renderActiveGiveaways();
            renderActiveGiveawaysMain();
            renderAllGiveawaysList();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º —Ä–æ–∑—ã–≥—Ä—ã—à–µ, –µ—Å–ª–∏ –æ–Ω –±—ã–ª –≤—ã–±—Ä–∞–Ω
            if (currentGiveawayId === giveawayId) {
                updateCurrentGiveawayInfo();
            }
        }
        
        function switchTab(tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            tabContents.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–Ω–æ–ø–∫—É
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            updateGiveawaySelectors();
            updateCurrentGiveawayInfo();
            renderActiveGiveawaysMain();
            renderAllGiveawaysList();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            registerParticipantBtn.addEventListener('click', registerParticipant);
            
            currentGiveawaySelect.addEventListener('change', function() {
                currentGiveawayId = this.value;
                updateCurrentGiveawayInfo();
            });
            
            adminBtn.addEventListener('click', function() {
                adminPanel.style.display = 'block';
            });
            
            closeAdminBtn.addEventListener('click', function() {
                adminPanel.style.display = 'none';
            });
            
            adminLoginBtn.addEventListener('click', adminLogin);
            
            createGiveawayBtn.addEventListener('click', createGiveaway);
            updateGiveawayBtn.addEventListener('click', updateGiveaway);
            
            giveawayFilter.addEventListener('change', renderParticipantsTable);
            
            giveawayForWinner.addEventListener('change', function() {
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏ —Å–º–µ–Ω–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∞
            });
            
            drawRandomBtn.addEventListener('click', drawRandomWinner);
            drawAllWinnersBtn.addEventListener('click', drawAllWinners);
            confirmWinnerBtn.addEventListener('click', confirmWinner);
            confirmRedrawBtn.addEventListener('click', redrawWinner);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–∫–ª–∞–¥–æ–∫
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –Ω–∞–∂–∞—Ç–∏—é Enter
            const registrationInputs = [
                participantTwitchInput, 
                participantTelegramInput, 
                participantCodeInput
            ];
            
            registrationInputs.forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        registerParticipant();
                    }
                });
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∫—É –ø–æ –Ω–∞–∂–∞—Ç–∏—é Enter
            adminPasswordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    adminLogin();
                }
            });
        });
    </script>
</body>
</html>
